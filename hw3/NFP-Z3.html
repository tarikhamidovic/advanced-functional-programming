<!DOCTYPE html> <html xmlns=http://www.w3.org/1999/xhtml lang xml:lang style><!--
 Page saved with SingleFile 
 url: http://localhost:8080/hw_out/hw3.html 
 saved date: Mon Dec 20 2021 15:07:30 GMT+0100 (Central European Standard Time)
--><meta charset=utf-8>
<meta name=generator content=pandoc>
<meta name=viewport content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name=author content="Amer Hasanović">
<title>Napredno funkcionalno programiranje</title>
<style>html{line-height:1.5;font-family:Georgia,serif;font-size:20px;color:#1a1a1a;background-color:#fdfdfd}body{margin:0 auto;max-width:36em;padding-left:50px;padding-right:50px;padding-top:50px;padding-bottom:50px;hyphens:auto;overflow-wrap:break-word;text-rendering:optimizeLegibility;font-kerning:normal}@media (max-width:600px){body{font-size:0.9em;padding:1em}}@media print{body{background-color:transparent;color:black;font-size:12pt}p,h2,h3{orphans:3;widows:3}h2,h3,h4{page-break-after:avoid}}p{margin:1em 0}a{color:#1a1a1a}a:visited{color:#1a1a1a}img{max-width:100%}h1,h2,h3,h4,h5,h6{margin-top:1.4em}h5,h6{font-size:1em;font-style:italic}h6{font-weight:normal}ol,ul{padding-left:1.7em;margin-top:1em}li>ol,li>ul{margin-top:0}blockquote{margin:1em 0 1em 1.7em;padding-left:1em;border-left:2px solid #e6e6e6;color:#606060}code{font-family:Menlo,Monaco,'Lucida Console',Consolas,monospace;font-size:85%;margin:0}pre{margin:1em 0;overflow:auto}pre code{padding:0;overflow:visible;overflow-wrap:normal}.sourceCode{background-color:transparent;overflow:visible}hr{background-color:#1a1a1a;border:none;height:1px;margin:1em 0}table{margin:1em 0;border-collapse:collapse;width:100%;overflow-x:auto;display:block;font-variant-numeric:lining-nums tabular-nums}table caption{margin-bottom:0.75em}tbody{margin-top:0.5em;border-top:1px solid #1a1a1a;border-bottom:1px solid #1a1a1a}th{border-top:1px solid #1a1a1a;padding:0.25em 0.5em 0.25em 0.5em}td{padding:0.125em 0.5em 0.25em 0.5em}header{margin-bottom:4em;text-align:center}#TOC li{list-style:none}#TOC a:not(:hover){text-decoration:none}code{white-space:pre-wrap}span.smallcaps{font-variant:small-caps}span.underline{text-decoration:underline}div.column{display:inline-block;vertical-align:top;width:50%}div.hanging-indent{margin-left:1.5em;text-indent:-1.5em}ul.task-list{list-style:none}pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em;color:#aaaaaa}pre.numberSource{margin-left:3em;border-left:1px solid #aaaaaa;padding-left:4px}div.sourceCode{}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}code span.al{color:#ff0000;font-weight:bold}code span.an{color:#60a0b0;font-weight:bold;font-style:italic}code span.at{color:#7d9029}code span.bn{color:#40a070}code span.bu{}code span.cf{color:#007020;font-weight:bold}code span.ch{color:#4070a0}code span.cn{color:#880000}code span.co{color:#60a0b0;font-style:italic}code span.cv{color:#60a0b0;font-weight:bold;font-style:italic}code span.do{color:#ba2121;font-style:italic}code span.dt{color:#902000}code span.dv{color:#40a070}code span.er{color:#ff0000;font-weight:bold}code span.ex{}code span.fl{color:#40a070}code span.fu{color:#06287e}code span.im{}code span.in{color:#60a0b0;font-weight:bold;font-style:italic}code span.kw{color:#007020;font-weight:bold}code span.op{color:#666666}code span.ot{color:#007020}code span.pp{color:#bc7a00}code span.sc{color:#4070a0}code span.ss{color:#bb6688}code span.st{color:#4070a0}code span.va{color:#19177c}code span.vs{color:#4070a0}code span.wa{color:#60a0b0;font-weight:bold;font-style:italic}</style>
<!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<link type=image/x-icon rel="shortcut icon" href="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><link rel=canonical href=http://localhost:8080/hw_out/hw3.html></head>
<body>
<header id=title-block-header>
<h1 class=title>Napredno funkcionalno programiranje</h1>
<p class=subtitle>Zadaća 3</p>
<p class=author>Amer Hasanović</p>
</header>
<h2 id=problem-1>Problem 1</h2>
<p>U modulu <code>MySet</code> data je početna definicija klase <code>ActsAsSet</code>, koja predstavlja generički interfejs za tipove koji se mogu ponašati kao setovi:</p>
<div class=sourceCode id=cb1><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id=cb1-1><a href=#cb1-1 aria-hidden=true tabindex=-1></a><span class=ot>{-# OPTIONS_GHC -Wall #-}</span></span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-3><a href=#cb1-3 aria-hidden=true tabindex=-1></a><span class=kw>module</span> <span class=dt>MySet</span> <span class=kw>where</span></span>
<span id=cb1-4><a href=#cb1-4 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-5><a href=#cb1-5 aria-hidden=true tabindex=-1></a><span class=kw>class</span> <span class=dt>ActsAsSet</span> f <span class=kw>where</span></span>
<span id=cb1-6><a href=#cb1-6 aria-hidden=true tabindex=-1></a><span class=ot>  emp ::</span> f a</span>
<span id=cb1-7><a href=#cb1-7 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-8><a href=#cb1-8 aria-hidden=true tabindex=-1></a><span class=ot>  singleton ::</span> a <span class=ot>-&gt;</span> f a</span>
<span id=cb1-9><a href=#cb1-9 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-10><a href=#cb1-10 aria-hidden=true tabindex=-1></a><span class=ot>  insert ::</span> <span class=dt>Ord</span> a <span class=ot>=&gt;</span> a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> f a</span>
<span id=cb1-11><a href=#cb1-11 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-12><a href=#cb1-12 aria-hidden=true tabindex=-1></a><span class=ot>  getElement ::</span> <span class=dt>Ord</span> a <span class=ot>=&gt;</span> a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> <span class=dt>Maybe</span> a</span>
<span id=cb1-13><a href=#cb1-13 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-14><a href=#cb1-14 aria-hidden=true tabindex=-1></a><span class=ot>  fold ::</span> (a <span class=ot>-&gt;</span> b <span class=ot>-&gt;</span> b) <span class=ot>-&gt;</span> b <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> b</span>
<span id=cb1-15><a href=#cb1-15 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-16><a href=#cb1-16 aria-hidden=true tabindex=-1></a><span class=ot>  delete ::</span> <span class=dt>Ord</span> a <span class=ot>=&gt;</span> a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> f a</span>
<span id=cb1-17><a href=#cb1-17 aria-hidden=true tabindex=-1></a>  delete x  <span class=ot>=</span> fold (\y s <span class=ot>-&gt;</span> <span class=kw>if</span> x <span class=op>==</span> y <span class=kw>then</span> s <span class=kw>else</span> insert y s) emp</span>
<span id=cb1-18><a href=#cb1-18 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-19><a href=#cb1-19 aria-hidden=true tabindex=-1></a><span class=ot>  union ::</span> <span class=dt>Ord</span> a <span class=ot>=&gt;</span> f a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> f a</span>
<span id=cb1-20><a href=#cb1-20 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-21><a href=#cb1-21 aria-hidden=true tabindex=-1></a><span class=ot>  isEmpty ::</span> f a <span class=ot>-&gt;</span> <span class=dt>Bool</span></span>
<span id=cb1-22><a href=#cb1-22 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-23><a href=#cb1-23 aria-hidden=true tabindex=-1></a><span class=ot>  size ::</span> f a <span class=ot>-&gt;</span> <span class=dt>Int</span></span>
<span id=cb1-24><a href=#cb1-24 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-25><a href=#cb1-25 aria-hidden=true tabindex=-1></a><span class=ot>  isIn ::</span> <span class=dt>Ord</span> a <span class=ot>=&gt;</span> a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> <span class=dt>Bool</span></span>
<span id=cb1-26><a href=#cb1-26 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-27><a href=#cb1-27 aria-hidden=true tabindex=-1></a><span class=ot>  toSortedList ::</span> f a <span class=ot>-&gt;</span> [a]</span></code></pre></div>
<h3 id=zadatak-1>Zadatak 1</h3>
<p>U klasi <code>ActsAsSet</code> postoji osnovna implementacija funkcije <code>delete</code>. Modificirajte klasu tako da dodate osnovne implementacije funkcija <code>union</code>, <code>isEmpty</code>, <code>size</code>, <code>isIn</code> i <code>toSortedList</code>.</p>
<h3 id=zadatak-2>Zadatak 2</h3>
<p>Unutar modula <code>MySet</code> implementirajte slijedeće funkcije:</p>
<div class=sourceCode id=cb2><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id=cb2-1><a href=#cb2-1 aria-hidden=true tabindex=-1></a><span class=ot>fromList ::</span> (<span class=dt>ActsAsSet</span> f, <span class=dt>Ord</span> a) <span class=ot>=&gt;</span> [a] <span class=ot>-&gt;</span> f a</span>
<span id=cb2-2><a href=#cb2-2 aria-hidden=true tabindex=-1></a>fromList <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb2-3><a href=#cb2-3 aria-hidden=true tabindex=-1></a></span>
<span id=cb2-4><a href=#cb2-4 aria-hidden=true tabindex=-1></a><span class=ot>difference ::</span> (<span class=dt>ActsAsSet</span> f, <span class=dt>Ord</span> a) <span class=ot>=&gt;</span> f a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> f a</span>
<span id=cb2-5><a href=#cb2-5 aria-hidden=true tabindex=-1></a>difference xs ys <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb2-6><a href=#cb2-6 aria-hidden=true tabindex=-1></a></span>
<span id=cb2-7><a href=#cb2-7 aria-hidden=true tabindex=-1></a><span class=ot>subset ::</span> (<span class=dt>ActsAsSet</span> f, <span class=dt>Ord</span> a) <span class=ot>=&gt;</span> f a <span class=ot>-&gt;</span> f a <span class=ot>-&gt;</span> <span class=dt>Bool</span></span>
<span id=cb2-8><a href=#cb2-8 aria-hidden=true tabindex=-1></a>subset xs ys <span class=ot>=</span> <span class=fu>undefined</span></span></code></pre></div>
<p>Gdje <code>difference xs ys</code> vraća kontejner sa elementima iz <code>xs</code> koji nisu u <code>ys</code>, a <code>subset xs ys</code> predstavlja test da li su svi elementi iz <code>xs</code> ujedno i elementi u <code>ys</code>.</p>
<h3 id=zadatak-3>Zadatak 3</h3>
<p>Sa stanovište algoritamske kompleksnosti unutar modula <code>MySet</code> napravite što bolje instance klase <code>ActsAsSet</code> za Haskell liste, kao i za tip <code>Tree</code>, gdje je tip <code>Tree</code> definiran kao:</p>
<div class=sourceCode id=cb3><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id=cb3-1><a href=#cb3-1 aria-hidden=true tabindex=-1></a><span class=kw>data</span> <span class=dt>Tree</span> a <span class=ot>=</span> <span class=dt>Empty</span> <span class=op>|</span> <span class=dt>Node</span> (<span class=dt>Tree</span> a) a (<span class=dt>Tree</span> a) <span class=kw>deriving</span> (<span class=dt>Show</span>, <span class=dt>Eq</span>)</span></code></pre></div>
<h3 id=zadatak-4>Zadatak 4</h3>
<p>Neka je unutar modula <code>MySet</code> dat sljedeći kod:</p>
<div class=sourceCode id=cb4><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id=cb4-1><a href=#cb4-1 aria-hidden=true tabindex=-1></a><span class=kw>newtype</span> <span class=dt>Pair</span> k v <span class=ot>=</span> <span class=dt>Pair</span> {<span class=ot> getTuple ::</span> (k,v) }</span>
<span id=cb4-2><a href=#cb4-2 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-3><a href=#cb4-3 aria-hidden=true tabindex=-1></a><span class=kw>instance</span> <span class=dt>Eq</span> k <span class=ot>=&gt;</span> <span class=dt>Eq</span> (<span class=dt>Pair</span> k v) <span class=kw>where</span></span>
<span id=cb4-4><a href=#cb4-4 aria-hidden=true tabindex=-1></a>  (<span class=dt>Pair</span> kv1) <span class=op>==</span> (<span class=dt>Pair</span> kv2) <span class=ot>=</span> <span class=fu>fst</span> kv1 <span class=op>==</span> <span class=fu>fst</span> kv2</span>
<span id=cb4-5><a href=#cb4-5 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-6><a href=#cb4-6 aria-hidden=true tabindex=-1></a><span class=kw>instance</span> <span class=dt>Ord</span> k <span class=ot>=&gt;</span> <span class=dt>Ord</span> (<span class=dt>Pair</span> k v) <span class=kw>where</span></span>
<span id=cb4-7><a href=#cb4-7 aria-hidden=true tabindex=-1></a>  <span class=fu>compare</span> (<span class=dt>Pair</span> kv1) (<span class=dt>Pair</span> kv2) <span class=ot>=</span> <span class=fu>compare</span> (<span class=fu>fst</span> kv1) (<span class=fu>fst</span> kv2)</span>
<span id=cb4-8><a href=#cb4-8 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-9><a href=#cb4-9 aria-hidden=true tabindex=-1></a><span class=kw>instance</span> (<span class=dt>Show</span> k, <span class=dt>Show</span> v) <span class=ot>=&gt;</span> <span class=dt>Show</span> (<span class=dt>Pair</span> k v) <span class=kw>where</span></span>
<span id=cb4-10><a href=#cb4-10 aria-hidden=true tabindex=-1></a>  <span class=fu>show</span> (<span class=dt>Pair</span> (k,v)) <span class=ot>=</span> <span class=fu>show</span> k <span class=op>++</span> <span class=st>" |-&gt; "</span> <span class=op>++</span> <span class=fu>show</span> v</span>
<span id=cb4-11><a href=#cb4-11 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-12><a href=#cb4-12 aria-hidden=true tabindex=-1></a><span class=kw>type</span> <span class=dt>Map</span> f k v <span class=ot>=</span> f (<span class=dt>Pair</span> k v)</span>
<span id=cb4-13><a href=#cb4-13 aria-hidden=true tabindex=-1></a><span class=kw>type</span> <span class=dt>ListMap</span> k v <span class=ot>=</span> <span class=dt>Map</span> [] k v</span>
<span id=cb4-14><a href=#cb4-14 aria-hidden=true tabindex=-1></a><span class=kw>type</span> <span class=dt>TreeMap</span> k v <span class=ot>=</span> <span class=dt>Map</span> <span class=dt>Tree</span> k v</span>
<span id=cb4-15><a href=#cb4-15 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-16><a href=#cb4-16 aria-hidden=true tabindex=-1></a><span class=ot>emptyMap ::</span> <span class=dt>ActsAsSet</span> f <span class=ot>=&gt;</span> <span class=dt>Map</span> f k v</span>
<span id=cb4-17><a href=#cb4-17 aria-hidden=true tabindex=-1></a>emptyMap <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb4-18><a href=#cb4-18 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-19><a href=#cb4-19 aria-hidden=true tabindex=-1></a><span class=ot>extend ::</span> (<span class=dt>ActsAsSet</span> f, <span class=dt>Ord</span> k) <span class=ot>=&gt;</span> k <span class=ot>-&gt;</span> v <span class=ot>-&gt;</span> <span class=dt>Map</span> f k v <span class=ot>-&gt;</span> <span class=dt>Map</span> f k v</span>
<span id=cb4-20><a href=#cb4-20 aria-hidden=true tabindex=-1></a>extend k v <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb4-21><a href=#cb4-21 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-22><a href=#cb4-22 aria-hidden=true tabindex=-1></a><span class=ot>toSList ::</span> <span class=dt>ActsAsSet</span> f <span class=ot>=&gt;</span> <span class=dt>Map</span> f k v <span class=ot>-&gt;</span> [(k,v)]</span>
<span id=cb4-23><a href=#cb4-23 aria-hidden=true tabindex=-1></a>toSList <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb4-24><a href=#cb4-24 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-25><a href=#cb4-25 aria-hidden=true tabindex=-1></a><span class=fu>lookup</span><span class=ot> ::</span> (<span class=dt>ActsAsSet</span> f, <span class=dt>Ord</span> k) <span class=ot>=&gt;</span> k <span class=ot>-&gt;</span> <span class=dt>Map</span> f k v <span class=ot>-&gt;</span> <span class=dt>Maybe</span> v</span>
<span id=cb4-26><a href=#cb4-26 aria-hidden=true tabindex=-1></a><span class=fu>lookup</span> k  <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb4-27><a href=#cb4-27 aria-hidden=true tabindex=-1></a></span>
<span id=cb4-28><a href=#cb4-28 aria-hidden=true tabindex=-1></a><span class=ot>remove ::</span> (<span class=dt>ActsAsSet</span> f, <span class=dt>Ord</span> k) <span class=ot>=&gt;</span> k <span class=ot>-&gt;</span> <span class=dt>Map</span> f k v <span class=ot>-&gt;</span> <span class=dt>Map</span> f k v</span>
<span id=cb4-29><a href=#cb4-29 aria-hidden=true tabindex=-1></a>remove k <span class=ot>=</span> <span class=fu>undefined</span></span></code></pre></div>
<p>Implementirajte funkcije <code>emptyMap</code>, <code>extend</code> i <code>toSList</code>.</p>
<p>Ukoliko je moguće implementirajte funkcije <code>lookup</code> i <code>remove</code>, u suprotnom, predložite i obrazložite neophodne promjene u kodu, a zatim implementirajte <code>lookup</code> i <code>remove</code>.</p>
<h2 id=problem-2>Problem 2</h2>
<p>U modulu <code>Math</code> dat je sljedeći kod:</p>
<div class=sourceCode id=cb5><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id=cb5-1><a href=#cb5-1 aria-hidden=true tabindex=-1></a><span class=ot>{-# OPTIONS_GHC -Wall #-}</span></span>
<span id=cb5-2><a href=#cb5-2 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-3><a href=#cb5-3 aria-hidden=true tabindex=-1></a><span class=kw>module</span> <span class=dt>Math</span> <span class=kw>where</span></span>
<span id=cb5-4><a href=#cb5-4 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-5><a href=#cb5-5 aria-hidden=true tabindex=-1></a><span class=kw>import</span> <span class=dt>Text.ParserCombinators.ReadP</span></span>
<span id=cb5-6><a href=#cb5-6 aria-hidden=true tabindex=-1></a><span class=kw>import</span> <span class=dt>Data.Char</span></span>
<span id=cb5-7><a href=#cb5-7 aria-hidden=true tabindex=-1></a><span class=kw>import</span> <span class=dt>Control.Applicative</span> <span class=kw>hiding</span> (optional)</span>
<span id=cb5-8><a href=#cb5-8 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-9><a href=#cb5-9 aria-hidden=true tabindex=-1></a><span class=kw>data</span> <span class=dt>MExp</span> a <span class=ot>=</span></span>
<span id=cb5-10><a href=#cb5-10 aria-hidden=true tabindex=-1></a>    <span class=dt>Num</span> a</span>
<span id=cb5-11><a href=#cb5-11 aria-hidden=true tabindex=-1></a>  <span class=op>|</span> <span class=dt>Add</span> (<span class=dt>MExp</span> a) (<span class=dt>MExp</span> a)</span>
<span id=cb5-12><a href=#cb5-12 aria-hidden=true tabindex=-1></a>  <span class=op>|</span> <span class=dt>Multiply</span> (<span class=dt>MExp</span> a) (<span class=dt>MExp</span> a)</span>
<span id=cb5-13><a href=#cb5-13 aria-hidden=true tabindex=-1></a>  <span class=op>|</span> <span class=dt>Subtract</span> (<span class=dt>MExp</span> a) (<span class=dt>MExp</span> a) <span class=kw>deriving</span> (<span class=dt>Show</span>)</span>
<span id=cb5-14><a href=#cb5-14 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-15><a href=#cb5-15 aria-hidden=true tabindex=-1></a><span class=ot>compute ::</span> (<span class=dt>Num</span> a) <span class=ot>=&gt;</span> <span class=dt>MExp</span> a <span class=ot>-&gt;</span> a</span>
<span id=cb5-16><a href=#cb5-16 aria-hidden=true tabindex=-1></a>compute (<span class=dt>Num</span> a) <span class=ot>=</span> <span class=fu>undefined</span></span>
<span id=cb5-17><a href=#cb5-17 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-18><a href=#cb5-18 aria-hidden=true tabindex=-1></a><span class=ot>pNum ::</span> <span class=dt>String</span> <span class=ot>-&gt;</span> <span class=dt>Integer</span></span>
<span id=cb5-19><a href=#cb5-19 aria-hidden=true tabindex=-1></a>pNum <span class=ot>=</span> <span class=fu>read</span> </span>
<span id=cb5-20><a href=#cb5-20 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-21><a href=#cb5-21 aria-hidden=true tabindex=-1></a><span class=ot>number ::</span> <span class=dt>ReadP</span> (<span class=dt>MExp</span> <span class=dt>Integer</span>)</span>
<span id=cb5-22><a href=#cb5-22 aria-hidden=true tabindex=-1></a>number <span class=ot>=</span> <span class=kw>do</span></span>
<span id=cb5-23><a href=#cb5-23 aria-hidden=true tabindex=-1></a>  a <span class=ot>&lt;-</span> option <span class=st>""</span> (string <span class=st>"-"</span>)</span>
<span id=cb5-24><a href=#cb5-24 aria-hidden=true tabindex=-1></a>  b <span class=ot>&lt;-</span> munch1 <span class=fu>isDigit</span></span>
<span id=cb5-25><a href=#cb5-25 aria-hidden=true tabindex=-1></a>  <span class=fu>pure</span> <span class=op>$</span> <span class=dt>Num</span> <span class=op>$</span> pNum (a<span class=op>++</span>b)</span>
<span id=cb5-26><a href=#cb5-26 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-27><a href=#cb5-27 aria-hidden=true tabindex=-1></a><span class=ot>parsePlusOrMinus ::</span> <span class=dt>ReadP</span> (<span class=dt>MExp</span> <span class=dt>Integer</span>)</span>
<span id=cb5-28><a href=#cb5-28 aria-hidden=true tabindex=-1></a>parsePlusOrMinus <span class=ot>=</span> <span class=kw>do</span></span>
<span id=cb5-29><a href=#cb5-29 aria-hidden=true tabindex=-1></a>  a <span class=ot>&lt;-</span> term</span>
<span id=cb5-30><a href=#cb5-30 aria-hidden=true tabindex=-1></a>  op <span class=ot>&lt;-</span> char <span class=ch>'+'</span> <span class=op>&lt;|&gt;</span> char <span class=ch>'-'</span></span>
<span id=cb5-31><a href=#cb5-31 aria-hidden=true tabindex=-1></a>  b <span class=ot>&lt;-</span> mexpr</span>
<span id=cb5-32><a href=#cb5-32 aria-hidden=true tabindex=-1></a>  <span class=kw>case</span> op <span class=kw>of</span> </span>
<span id=cb5-33><a href=#cb5-33 aria-hidden=true tabindex=-1></a>    <span class=ch>'+'</span> <span class=ot>-&gt;</span> <span class=fu>pure</span> <span class=op>$</span> <span class=dt>Add</span> a b</span>
<span id=cb5-34><a href=#cb5-34 aria-hidden=true tabindex=-1></a>    _ <span class=ot>-&gt;</span> <span class=fu>pure</span> <span class=op>$</span> <span class=dt>Subtract</span> a b</span>
<span id=cb5-35><a href=#cb5-35 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-36><a href=#cb5-36 aria-hidden=true tabindex=-1></a><span class=ot>mexpr ::</span> <span class=dt>ReadP</span> (<span class=dt>MExp</span> <span class=dt>Integer</span>)</span>
<span id=cb5-37><a href=#cb5-37 aria-hidden=true tabindex=-1></a>mexpr <span class=ot>=</span> parsePlusOrMinus <span class=op>&lt;|&gt;</span> term </span>
<span id=cb5-38><a href=#cb5-38 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-39><a href=#cb5-39 aria-hidden=true tabindex=-1></a><span class=ot>term ::</span> <span class=dt>ReadP</span> (<span class=dt>MExp</span> <span class=dt>Integer</span>)</span>
<span id=cb5-40><a href=#cb5-40 aria-hidden=true tabindex=-1></a>term <span class=ot>=</span> parseTimes <span class=op>&lt;|&gt;</span> number </span>
<span id=cb5-41><a href=#cb5-41 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-42><a href=#cb5-42 aria-hidden=true tabindex=-1></a><span class=ot>parseTimes ::</span> <span class=dt>ReadP</span> (<span class=dt>MExp</span> <span class=dt>Integer</span>)</span>
<span id=cb5-43><a href=#cb5-43 aria-hidden=true tabindex=-1></a>parseTimes <span class=ot>=</span> <span class=kw>do</span></span>
<span id=cb5-44><a href=#cb5-44 aria-hidden=true tabindex=-1></a>  a <span class=ot>&lt;-</span> number</span>
<span id=cb5-45><a href=#cb5-45 aria-hidden=true tabindex=-1></a>  _ <span class=ot>&lt;-</span> char <span class=ch>'*'</span></span>
<span id=cb5-46><a href=#cb5-46 aria-hidden=true tabindex=-1></a>  b <span class=ot>&lt;-</span> term</span>
<span id=cb5-47><a href=#cb5-47 aria-hidden=true tabindex=-1></a>  <span class=fu>pure</span> <span class=op>$</span> <span class=dt>Multiply</span> a b</span>
<span id=cb5-48><a href=#cb5-48 aria-hidden=true tabindex=-1></a></span>
<span id=cb5-49><a href=#cb5-49 aria-hidden=true tabindex=-1></a><span class=ot>parseMExp ::</span> <span class=dt>String</span> <span class=ot>-&gt;</span> <span class=dt>Maybe</span> (<span class=dt>MExp</span> <span class=dt>Integer</span>)</span>
<span id=cb5-50><a href=#cb5-50 aria-hidden=true tabindex=-1></a>parseMExp input <span class=ot>=</span> <span class=kw>case</span> readP_to_S mexpr input <span class=kw>of</span></span>
<span id=cb5-51><a href=#cb5-51 aria-hidden=true tabindex=-1></a>    [] <span class=ot>-&gt;</span> <span class=dt>Nothing</span></span>
<span id=cb5-52><a href=#cb5-52 aria-hidden=true tabindex=-1></a>    xs <span class=ot>-&gt;</span> (<span class=dt>Just</span> <span class=op>.</span> <span class=fu>fst</span> <span class=op>.</span> <span class=fu>last</span>) xs</span></code></pre></div>
<p>Tip <code>MExp</code> predstavlja <code>Haskell</code> reprezentaciju matematičkog izraza sa jednostavnim operacijama sabiranja, oduzimanja i množenja. Funkcija <code>parseMExp</code> omogućava konvertovanje (parsiranje) <code>String</code>-a u <code>MExp</code>, pod uslovom da je sadržaj stringa validni matematički izraz, npr:</p>
<pre class=text><code>GHCi, version 8.10.7: https://www.haskell.org/ghc/  :? for help
Prelude&gt; :load Math.hs
[1 of 1] Compiling Math             ( Math.hs, interpreted )
Ok, one module loaded.
*Math&gt; parseMExp "2"
Just (Num 2)
*Math&gt; parseMExp "2+3"
Just (Add (Num 2) (Num 3))
*Math&gt; parseMExp "-4*2+3*5*4"
Just (Add (Multiply (Num (-4)) (Num 2)) (Multiply (Num 3) (Multiply (Num 5) (Num 4))))
*Math&gt; parseMExp "*8"
Nothing
*Math&gt; parseMExp "*dskfj"
Nothing</code></pre>
<h3 id=zadatak-1-1>Zadatak 1</h3>
<p>Implementirajte funkciju <code>compute</code> koja vraća rezultat proračuna matematičkog izraza predstavljenog putem <code>MExpr</code>, npr:</p>
<pre class=text><code>*Math&gt; compute &lt;$&gt; parseMExp "2"
Just 2
*Math&gt; compute &lt;$&gt; parseMExp "2*2"
Just 4
*Math&gt; compute &lt;$&gt; parseMExp "2+4*3-8*25"
Just (-186)</code></pre>
<h3 id=zadatak-2-1>Zadatak 2</h3>
<p>Implementirajte <strong>minimalni</strong> neophodni kod kako bi sljedeće linije koda bile ispravne i proizvodile rezultate kao u primjeru:</p>
<pre class=text><code>*Math&gt; parseMExp "2" == parseMExp "1+1+0"
True
*Math&gt; parseMExp "2*4" &gt; parseMExp "2+2+2"
True
*Math&gt; parseMExp "2*4" &lt; parseMExp "100-40"
True
*Math&gt; (+) &lt;$&gt; parseMExp "2*4" &lt;*&gt; parseMExp "100-40"
Just (Num 68)</code></pre>
